name: Boat Race 2025 Full Year Collector

on:
  workflow_dispatch:

jobs:
  collect:
    strategy:
      fail-fast: false
      matrix:
        # 2025å¹´ã®1æœˆã€œ12æœˆã‚’ã€12å°ã®ä¸¦åˆ—ãƒ©ãƒ³ãƒŠãƒ¼ã§ä¸€æ°—ã«åé›†ã—ã¾ã™
        include:
          - { month: "01", s: "2025-01-01", e: "2025-01-31" }
          - { month: "02", s: "2025-02-01", e: "2025-02-28" }
          - { month: "03", s: "2025-03-01", e: "2025-03-31" }
          - { month: "04", s: "2025-04-01", e: "2025-04-30" }
          - { month: "05", s: "2025-05-01", e: "2025-05-31" }
          - { month: "06", s: "2025-06-01", e: "2025-06-30" }
          - { month: "07", s: "2025-07-01", e: "2025-07-31" }
          - { month: "08", s: "2025-08-01", e: "2025-08-31" }
          - { month: "09", s: "2025-09-01", e: "2025-09-30" }
          - { month: "10", s: "2025-10-01", e: "2025-10-31" }
          - { month: "11", s: "2025-11-01", e: "2025-11-30" }
          - { month: "12", s: "2025-12-01", e: "2025-12-31" }

    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - run: pip install pandas requests beautifulsoup4

      - name: ãƒ‡ãƒ¼ã‚¿åé›† (8ä¸¦åˆ—)
        run: python -u collector.py --start ${{ matrix.s }} --end ${{ matrix.e }}

      - name: æˆæœç‰©ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
        uses: actions/upload-artifact@v4
        with:
          name: data-2025-${{ matrix.month }}
          path: data/*.csv

  notify:
    needs: collect
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: Discordé€šçŸ¥
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d "{\"username\": \"Sniper_Bot\", \"content\": \"ğŸ“… **2025å¹´ å…¨ãƒ‡ãƒ¼ã‚¿åé›†å®Œäº†**\nArtifactsã‹ã‚‰12ãƒ¶æœˆåˆ†ã®CSVã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ï¼\"}" \
               ${{ secrets.DISCORD_WEBHOOK_URL }}
